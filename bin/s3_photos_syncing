#!/usr/bin/env jruby

$:.push File.expand_path('../../lib', __FILE__)

require 's3_photos_syncing'
require 'thor'

class S3PhotosSyncingScript < Thor
  desc 'start', 'Transfer objects from a bucket to another, asynchronously'
  method_option :destination,   type: :string,  required: true
  method_option :force,         type: :boolean, default: false
  method_option :maxthreads,    type: :numeric, default: 10
  method_option :source,        type: :string,  required: true

  def start
    configuration                         = {}
    configuration[:buckets]             ||= {}
    configuration[:buckets][:source]      = options[:source]
    configuration[:buckets][:destination] = options[:destination]
    configuration[:max_threads]           = options[:maxthreads]
    configuration[:force]                 = options[:force]

    S3PhotosSyncing.run(configuration)
  end
end

S3PhotosSyncingScript.start
